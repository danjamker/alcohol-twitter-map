extends layout
 
block content
    #map
    script(src='/polymaps/polymaps.min.js')
    link(rel='stylesheet', href='/polymaps/lib/colorbrewer.css')
    style(type='text/css')
        svg {
          display: block;
          overflow: hidden;
          width: 100%;
          height: 100%;
        }
        
        #copy {
          position: absolute;
          left: 0;
          bottom: 4px;
          padding-left: 5px;
          font: 9px sans-serif;
          color: #fff;
          cursor: default;
        }
        
        #copy a {
          color: #fff;
        }
        
        .compass .back {
          fill: #eee;
          fill-opacity: .8;
        }
        
        .compass .fore {
          stroke: #999;
          stroke-width: 1.5px;
        }
        
        .compass rect.back.fore {
          fill: #999;
          fill-opacity: .3;
          stroke: #eee;
          stroke-width: 1px;
          shape-rendering: crispEdges;
        }
        
        .compass .direction {
          fill: none;
        }
        
        .compass .chevron {
          fill: none;
          stroke: #999;
          stroke-width: 5px;
        }
        
        .compass .zoom .chevron {
          stroke-width: 4px;
        }
        
        .compass .active .chevron, .compass .chevron.active {
          stroke: #fff;
        }
        
        .compass.active .active .direction {
          fill: #999;
        }

    script(type='text/javascript')
        var po = org.polymaps;

        var map = po.map()
            .container(document.getElementById("map").appendChild(po.svg("svg")))
            .center({lat: 53, lon: -1})
            .zoom(4)
            .zoomRange([3, 7])
            .add(po.interact());
        
        map.add(po.image()
            .url(po.url("http://{S}tile.cloudmade.com"
            + "/1a1b06b230af4efdbb989ea99e9841af" // http://cloudmade.com/register
            + "/20760/256/{Z}/{X}/{Y}.png")
            .hosts(["a.", "b.", "c.", ""])));
        
        map.add(po.geoJson()
            .url("http://polymaps.appspot.com/county/{Z}/{X}/{Y}.json")
            .on("load", load)
            .id("county"));
        
        map.add(po.geoJson()
            .url("http://polymaps.appspot.com/state/{Z}/{X}/{Y}.json")
            .id("state"));
        
        map.add(po.compass()
            .pan("none"));
        
        function load(e) {
          for (var i = 0; i < e.features.length; i++) {
            var feature = e.features[i];
            feature.element.setAttribute("id", feature.data.id);
          }
        }