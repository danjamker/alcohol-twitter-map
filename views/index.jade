extends layout
block content
    #map
        // #map-ui
        //     ul
        //       li
        //         a#grid.active(href='#') Interactivity
        //       li
        //         a#legend(href='#') Legend
        //       li
        //         a#zoomer.active(href='#') Zoomer
        //       li
        //         a#fullscreen(href='#') Fullscreen
        //       li
        //         a#attribution.active(href='#') Attribution
        //       li
        //         a#hash(href='#') Hash
                
    //input(type="text", id="foo", class="container-narrow", value="", data-slider-min="0", data-slider-max="336", data-slider-step="1", data-slider-value="0", data-slider-orientation="horizontal", data-slider-selection="after",data-slider-tooltip="hide")
    script(src='http://api.tiles.mapbox.com/mapbox.js/v1.3.1/mapbox.js')
    link(href='http://api.tiles.mapbox.com/mapbox.js/v1.3.1/mapbox.css', rel='stylesheet')
    script(src='/javascripts/moment.min.js')
    link(rel='stylesheet', href='/CSS/2013-05-23T00.css', id="mapStyleSheet")
    link(rel='stylesheet', href='http://www.mapbox.com/mapbox.js/assets/leaflet.fullscreen.css')
    script(src='http://www.mapbox.com/mapbox.js/assets/Leaflet.fullscreen.js')
    script(src='http://www.mapbox.com/mapbox.js/assets/leaflet-hash.js')
    script(src='/javascripts/tileGeoJSON.js')

    style(type='text/css')
        @import('/CSS/2013-05-23T00.css')
        
        div.slider.slider-horizontal{
            width: 100%;
        }
        
        #map{
            width:600px;
            height:400px;
        }
    
        #map-ui {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 100;
        }
        
        #map-ui ul {
            list-style: none;
            margin: 0;
            padding: 0;
        }
        
        #map-ui a {
            font-size: 13px;
            background: #FFF;
            color: #3C4E5A;
            display: block;
            margin: 0;
            padding: 0;
            border: 1px solid #BBB;
            border-bottom-width: 0;
            min-width: 138px;
            padding: 10px;
            text-decoration: none;
        }
        
        #map-ui a:hover {
            background: #ECF5FA;
        }
        
        #map-ui li:last-child a {
            border-bottom-width: 1px;
            -webkit-border-radius: 0 0 3px 3px;
            border-radius: 0 0 3px 3px;
        }
        
        #map-ui li:first-child a {
            -webkit-border-radius: 3px 3px 0 0;
            border-radius: 3px 3px 0 0;
        }
        
        #map-ui a.active {
            background: #3887BE;
            border-color: #3887BE;
            border-top-color: #FFF;
            color: #FFF;
        }
        
        #map-ui li:first-child a.active {
            border-top-color: #3887BE;
        }
        
        #map .map-fullscreen {
            background-color: #28353D;
        }
    script(type='text/javascript')
        
        var style = {
            "clickable": true,
            "color": "#00D",
            "fillColor": "#00D",
            "weight": 1.0,
            "opacity": 0.3,
            "fillOpacity": 0.2
        };
        var hoverStyle = {
            "fillOpacity": 0.5
        };
    
        // $('#foo').slider().on('slide', function(ev){
        //   console.log(ev)
        //   tmp = moment("2013-05-23T00", "YYYY-MM-DD[T]HH").add('h', ev.value).format("YYYY-MM-DD[T]HH");;
        //     console.log(tmp)
        //     $("#mapStyleSheet").attr({href : "/CSS/"+tmp+".css"});
        // });
        
        
        // $("div.slider.slider-horizontal").attr('style', 'width: 100%;')
        
        var map = L.mapbox.map('map', 'examples.map-uci7ul8p', {attributionControl: false})
            .setView([38.82, -94.96], 4);
        // map.addLayer(L.tileLayer('http://alcohol-twitter-map.herokuapp.com/National.json'));
        // var legend = 'Data from Robert Kieffer.';
        // var fullscreenControl = new L.Control.Fullscreen().addTo(map);
        
        // var geojsonURL = 'http://http://alcohol-twitter-map.herokuapp.com/state/{z}/{x}/{y}.json';
        // var geojsonTileLayer = new L.TileLayer.GeoJSON(geojsonURL, {
        //         clipTiles: true,
        //         unique: function (feature) {
        //             return feature.id; 
        //         }
        //     }, {
        //         style: style,
        //         onEachFeature: function (feature, layer) {
        //             if (feature.properties) {
        //                 var popupString = '<div class="popup">';
        //                 for (var k in feature.properties) {
        //                     var v = feature.properties[k];
        //                     popupString += k + ': ' + v + '<br />';
        //                 }
        //                 popupString += '</div>';
        //                 layer.bindPopup(popupString);
        //             }
        //             if (!(layer instanceof L.Point)) {
        //                 layer.on('mouseover', function () {
        //                     layer.setStyle(hoverStyle);
        //                 });
        //                 layer.on('mouseout', function () {
        //                     layer.setStyle(style);
        //                 });
        //             }
        //         }
        //     }
        // );
        // map.addLayer(geojsonTileLayer);
        
        map.on("move", function(e) { console.log(e) });

        